<section style="margin-left:auto; margin-right:auto; width:fit-content">
	<h3>Please choose your favorite prediction and prompt/answer combination to present</h3>
	<form autocomplete="off" id="choose-form">
		<label for="prediction">Prediction</label><br>
		<section id="predictions">
		</section>
		<br>
		<label for="prompt">Prompt</label><br>
		<section id="prompts">
		</section>
		<br>
		<input type="submit" value="Submit">
	</form>
</section>

<script type="text/html" id="prediction_tmpl">
	<input type="radio" name="prediction" class="prediction" checked><label><%=prediction%></label><br>
</script>

<script type="text/html" id="prompt_tmpl">
	<input type="radio" name="prompt" checked><br>
	<label>Prompt:</label><br>
	<label><%=prompt%></label><br>
	<label>Answer:</label><br>
	<label><%=answer%></label><br>
</script>

<script>
	{
		var predictions = document.getElementById("predictions");
		var prompts = document.getElementById("prompts");
		var chooseForm = document.getElementById("choose-form");

		player.on_packet = (magic, packet) => {
			switch (magic) {
				case BingoMagic.Predictions:
					var text = decode_text(packet);
					for (const prediction of text.split("|")) {
						if (prediction == "") { continue }
						predictions.insertAdjacentHTML("beforeend", tmpl("prediction_tmpl", { prediction: prediction }));
					}
					break;
				case BingoMagic.TextPromptAnswer:
					var text = decode_text(packet);
					var split = text.split("|");
					prompts.insertAdjacentHTML("beforeend", tmpl("prompt_tmpl", { prompt: split[0], answer: split[1] }));
					break;
			}

		};

		chooseForm.onsubmit = (e) => {
			e.preventDefault();
			var children = predictions.querySelectorAll(".prediction");
			for (var i = 0; i < children.length; i++) {
				if (children[i].checked) {
					player.prepend_and_send(BingoMagic.TextPromptChoice, encode_text(i.toString()));
					break;
				}
			}
		};
	}
</script>